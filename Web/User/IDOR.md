# IDOR

**Insecure Direct Object Reference (также IDOR)** - уязвимость, присутствующая когда приложение, которое в открытом виде содержит упоминание внутреннего объекта реализации.

Данный вид уязвимости является следствием недостаточной проверки пользовательских данных. Суть ее заключается в том, что при выводе каких-либо конфиденциальных данных, например личных сообщений или учетных карточек клиентов, для доступа к объекту используется идентификатор, который передается в открытом виде в адресной строке браузера, и при этом не реализована проверка прав доступа к объектам.

Живым примером является программа для создания скриншотов **Lightshot**. В ней можно выгрузить скриншот на сайт ``https://prntscr.com``. После выгрузки генерируется ссылка вида `https://prnt.sc/xxxxxx`, где ***``xxxxxx``*** - символы латинского алфавита и цифры. Из-за маленького количества возможных вариантов ссылки злоумышленник может получить доступ к скриншотам, которые ему не предназначались.

[Программа для скрейпа с сервиса](https://github.com/mxrch/darkshot)

В данном случае IDOR использовался для получения несанкционированного доступа к данным.

Также IDOR может использоваться для:
* Выполнения несанкционированных операций:
> Допустим сервер принимает метод `DELETE /account/{uuid}`, позволяющий удалить аккаунт пользователя по заданному UUID **без авторизации**. Пользователь может послать запрос с пользователем, которого он хочет удалить и сервер этому никак не воспрепятствует.
* Управления объектами приложения:
> Например, в куках сайта может в открытом виде содержаться тип прав доступа к определённым функциям приложения. Изменив данный тип, например, на администратора, пользователь может получить доступ к той части приложения которая ему не предназначалась.
* Прямого доступа к файлам:
> Пример. На сайте школы  по адресам `/api/0/curriculum/lessons/` и `/api/0/files/<id>/content` доступны без дополнительной атворизации файлы не для учеников **(поурочные разработки по геометрии Атанасян ммм))) )**

## Как ловить данную уязвимость?

Самый очевидный способ - собрать дамп запросов с помощью ***BurpSuite***, ***WireShark*** или иной утилиты и проверить каждый запрос к нужному API на наличие определённого способа авторизации. 