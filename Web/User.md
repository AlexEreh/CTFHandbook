## IDOR

**Insecure Direct Object Reference (также IDOR)** - уязвимость, присутствующая, когда приложение в открытом виде содержит упоминание внутреннего объекта реализации.

Данный вид уязвимости является следствием недостаточной проверки пользовательских данных. Суть ее заключается в том, что при выводе каких-либо конфиденциальных данных, например личных сообщений или учетных данных, для доступа к объекту используется идентификатор, который передается в открытом виде в адресной строке браузера, и при этом не реализована проверка прав доступа к этим данным.

Живым примером является программа для создания скриншотов **Lightshot**. В ней можно выгрузить скриншот на сайт `https://prntscr.com`. После выгрузки генерируется ссылка вида `https://prnt.sc/xxxxxx`, где ***``xxxxxx``*** - символы латинского алфавита и цифры. Из-за маленького количества возможных вариантов ссылки злоумышленник может получить доступ к скриншотам, которые ему не предназначались.

[Программа для скрейпа с сервиса](https://github.com/mxrch/darkshot)

В данном случае IDOR использовался для получения несанкционированного доступа к данным.

Также IDOR может использоваться для:

* Выполнения несанкционированных операций:
> Допустим сервер принимает метод `DELETE /account/{uuid}`, позволяющий удалить аккаунт пользователя по заданному UUID **без авторизации**. Пользователь может послать запрос с пользователем, которого он хочет удалить и сервер этому никак не воспрепятствует.

* Управления объектами приложения:
> Например, в куках сайта может в открытом виде содержаться тип прав доступа к определённым функциям приложения. Изменив данный тип, например, на администратора, пользователь может получить доступ к той части приложения которая ему не предназначалась.

* Прямого доступа к файлам:
> Пример. На сайте школы  по адресам `/api/0/curriculum/lessons/` и `/api/0/files/<id>/content` доступны без дополнительной авторизации файлы не для учеников **(поурочные разработки по геометрии Атанасян ммм))) )**

### HPP (HTTP Parameter Pollution)

HPP уязвимости (подкидывание нескольких значений одному параметру) также могут приводить к IDOR. Некоторые приложения не смогут верно обработать ввод пользователем нескольких значений одному параметру, благодаря чему вы сможете обойти проверку доступа, установленную на эндпоинте.

> Если следующий запрос свалится с ошибкой:
>
> `GET /some_api/messages?user_id=ANOTHER_USERS_ID`
>
> Имеет смысл попробовать такой запрос:
>
> `GET /some_api/messages?user_id=YOUR_USER_ID&user_id=ANOTHER_USERS_ID`
>
> Или такой:
>
> `GET /some_api/messages?user_id=ANOTHER_USERS_ID&user_id=YOUR_USER_ID`
> 
> Или передать параметры с помощью списка:
> 
> `GET /some_api/messages?user_ids[]=YOUR_USER_ID&user_ids[]=ANOTHER_USERS_ID`
>
> Возможно, что один из таких запросов отработает неправильно и возвратит конфиденциальные данные.

[Подробнее про HPP](https://youtu.be/QVZBl8yxVX0?t=5)

# CSRF

# XSS
